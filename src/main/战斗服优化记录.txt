一、网络优化
1、客户端UDP发送绑定端口，解决收不到服务器包的问题
2、采用TCP和UDP双连接切换策略，做容错处理
3、kcp定时器优化

二、线程池优化
1、换掉老的线程池，采用DedicatedThreadPool
2、同一场战斗采用同一个线程池（单线程），可以避免并发问题
3、同一场战斗，不同场景采用同一个定时任务，减少定时任务创建
4、客户端代码采用服务器线程池运行，弃用系统线程池，性能提升不少

三、其他优化
1、匹配服id由匹配服带过来，减少战斗服对redis的操作
2、去掉日志打印获取堆栈信息，减少log消耗
3、客户端与战斗服的所有数据直连交互，避免网关服中转
4、定时器优化，采用单线程循环检测定时器，同一个任务通过设置任务下次执行时间，避免频繁创建任务
5、使用对象池，减少帧数据对象创建

四、优化过程
1、统计每个消息发送次数、流量、占总流量的比例，然后进行压缩120字节以上协议
2、jstack -l pid | grep 线程id或名字 -A 20  抓取CPU高的线程执行快照，查看他当前正在执行的代码，然后针对性优化
   jstack -l 13278 | grep Frame-Update -A 10
3、取消一些静态单位buff、技能（因为肯定不会有）列表的遍历，因为空map的遍历也有一定消耗
4、top -Hp 进程id 查看各个线程消耗cpu情况，发现是收发包线程占cpu比较多